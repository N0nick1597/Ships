#include <iostream>
#include <fstream>
#include <string>
#include <cstring>
#include <cstdlib>
#include <ctime>
#include <stdlib.h>
using namespace std;
int const Cmax=11;
class player{
	private:
		
	protected:
		string **CBOARD;//Kompiuterio lentele su laivais
		int LETTERS[Cmax], let;
		int NUMBERS[Cmax], numb;
		int DIRECTION[Cmax], dir;
		int DIRECT[Cmax], direc;
		int lett;
		string letter;
		int shoot;
	public:
		player(){
			CBOARD= new string*[Cmax];
			for(int i=0; i<Cmax; i++){
				CBOARD[i]=new string[Cmax];
			}
			for(int i=1; i<11; i++){
				for(int j=1; j<11; j++){
					CBOARD[i][j]="+";
				}
			}
		}
		void randoms(){
			int LETTERS[10]={1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
			let=LETTERS[rand()%10];
			//////////////////////////////////////////////////////// Raidziu random		
			int NUMBERS[10]={1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
			numb=NUMBERS[rand()%10];
			/////////////////////////////////////////////////////// Skaiciu random
			int DIRECTION[5]={4, 1, 2, 3, 4};
			dir=DIRECTION[rand()%4 + 1];
			//////////////////////////////////////////////////////  Krypties random 1- desine, 2- kaire, 3- virsus, 4-apacia
			int DIRECT[2]={1, 3 };
			direc=DIRECT[rand()%2];
		}
		void randomships(int n){
			int ind = n;
			randoms();
			if(direc==1){
				if(let+n<=10&&checking(n, direc, CBOARD, numb+1, let+1)){
					for(int i=let; i<let+n; i++){
						if(CBOARD[numb][i]!="O")
						CBOARD[numb][i]="O";
						else {
						
						cout<<"Bbbbbb";
						randomships(ind);
					}}
					
				}
				else{
					cout<<"Ccccccccc";
				//	randoms();
					randomships(ind);
					
				}
			}
			if(direc==3){
				if(numb+n-1<=10&&checking(n, direc, CBOARD, numb+1, let+1)){
					for(int j=numb; j<numb+n; j++){
						if(CBOARD[j][let]!="O")
						CBOARD[j][let]="O";
						else{
						
						cout<<"Ddddddd";
						randomships(ind);
					}}
				}
				else{
				cout<<"Aaaaaaaaaaaaa";
				//randoms();
				randomships(ind);
				}
			}
			cout<<endl;
			show(CBOARD);
	}
		void show(string **BOARD){
			string l [10]={"A", "B", "C", "D", "E", "F", "G", "H", "I", "J"};
			int a=0;
			for(int i=1; i<11; i++){
				if(i!=1){
					cout<<endl;	
				}
				if(i==1){
					cout<<"   ";
					for(int q=0; q<10; q++){
						cout<<l[q]<<" ";
					}
					cout<<endl;
				}
				for(int j=1; j<11; j++){
					if(j==1){
						if(a==9){
						cout<<"10 ";
					}
					else{
						a++;
						cout<<a<<"  ";
					}
					}
					cout<<BOARD[i][j]<<" ";
				}
			}
		}
		void convert(string letter){
			if(letter=="A"){
				lett=1;
			}
			else if(letter=="B"){
				lett=2;
			}
			else if(letter=="C"){
				lett=3;
			}
			else if(letter=="D"){
				lett=4;
			}
			else if(letter=="E"){
				lett=5;
			}
			else if(letter=="F"){
				lett=6;
			}
			else if(letter=="G"){
				lett=7;
			}
			else if(letter=="H"){
				lett=8;
			}
			else if(letter=="I"){
				lett=9;
			}
			else if(letter=="J"){
				lett=10;
			}
		}
		int getlett(){
			return lett;
		}
		bool checking(int n, int dir, string **BOARD, int numb, int let){
				if(dir==1){
					for(int i=let; i<let+n-1; i++){
						if (BOARD[numb][i]=="O"){
							return false;
						}
						else{
							return true;
						}
					}
				}
				else if(dir==2){
					for(int i=let; i>let-n+1; i--){
						if(BOARD[numb][i]=="O"){
							return false;
						}
						else{
							return true;
						}
					}
				}
				else if(dir==3){
					for(int i=numb; i<numb+n; i++){
						if(BOARD[i][let]=="O"){
							return false;
						}
						else{
							return true;
						}
					}
				}
				else if(dir==4){
					for(int i=numb; i>numb-n; i--){
						if(BOARD[i][let]=="O"){
							return false;
						}
						else{
							return true;
						}
					}
				}
		}
		void shooting(){
			cout<<"iveskite koordinate i kuria norite sauti"<<endl;
			cin>>letter>>shoot;
			convert(letter);
			cout<<lett<<"LETERIS";
			cout<<shoot<<"SKAICIUS";
			cout<<endl;
			if(CBOARD[shoot][getlett()]=="O"){
				CBOARD[shoot][getlett()]="X";
				cout<<"Pataikete!"<<endl;
				show(CBOARD);
			}
			else{
				CBOARD[shoot][getlett()]="-";
				cout<<endl;
				cout<<"nepataikete"<<endl;
				show(CBOARD);
			}
		}
		~player(){
			for(int i=0; i<Cmax; i++){
				delete CBOARD[i];
			}
			delete [] CBOARD;
			
		}
};
/**************************************************************************************************************************************************************************/
class computer: public player{
	private:
		int a;
		int number;
		int direction;
		int count;
	protected:
	    int lett;
		string **PBOARD;// zaidejo lentele su laivais
	public:
		computer(){
			PBOARD= new string*[Cmax];
			for(int i=0; i<Cmax; i++){
				PBOARD[i]=new string[Cmax];
			}
			for(int i=1; i<11; i++){
				for(int j=1; j<11; j++){
					PBOARD[i][j]="+";
				}
			}
		}
		
		bool around (int dir, int let1, int let2, int num1, int num2){
			cout<<"AAAAAA";
			cout<<dir<<"DIR"<<endl;
			cout<<let1<<"LET1"<<endl;
			cout<<let2<<"LET2"<<endl;
			cout<<num1<<"NUM1"<<endl;
			cout<<num2<<"NUM2"<<endl;
			if(dir==1){
				cout<<"BBBBB";
		    	for(int i = let1-1; i<=let2+1; i++){
		    		cout<<"CCCCCCC"<<i<<endl;
				    if((PBOARD[num1+1][i]=="O")&&(PBOARD[num1-1][i]=="O")&&(PBOARD[num1][let1-1]=="O")&&(PBOARD[num1][let2+1]=="O")){
				    	return false;
				    	cout<<"DDDDD";
					}
				}
				return true;
			}
			else if(dir==2){
				for(int i=num1-1; i<=num2+1; i++){
					if((PBOARD[i][let1-1]=="O")&&(PBOARD[i][let1+1]=="O")&&(PBOARD[num1-1][let1]=="O")&&(PBOARD[num2+1][let1]=="O")){
						return false;
						cout<<"EEEEEE";
					}
				}
			return true;
			}	
		}
		void ships(int size){
			cout<<"iveskite laivo krypti (1- desine, 2- kaire, 3- apacia, 4- virsus)"<<endl;
			cin>>direction;
			cout<<"Iveskite laivo pradine koordinate, pvz: A 5"<<endl;
			cin>>letter>>number;
			convert(letter);
			if(checking(size, direction, PBOARD, number, getlett())){
				if(direction==1){
					if(getlett()+size<=10&&(around(1, getlett(), getlett()+size-1, number, number)	)){
						for(int i=getlett(); i<getlett()+size; i++){
							PBOARD[number][i]="O";
						}
					}
					else{
						cout<<"Neperzenkite ribu!!!"<<endl;
						ships(size);
					}
				}
				else if(direction==2){
					if(getlett()-size>=1&&(around(1, getlett()-size-1, getlett(), number, number))){
						for(int i=getlett(); i>getlett()-size; i--){
							PBOARD[number][i]="O";
						}
					}
					else{
						cout<<"Neperzenkite ribu!!!"<<endl;
						ships(size);
					}
				}
				else if(direction==3){
					if(number+size<=10&&(around(2, getlett(), getlett(), number, number+size-1))){
						for(int i=number; i<number+size; i++){
							PBOARD[i][getlett()]="O";
						}
					}
					else{
						cout<<"Neperzenkite ribu!!!"<<endl;
						ships(size);
					}
				}
				else if(direction==4){
					if((number-size>=1)&&(around(2, getlett(), getlett(), number-size-1, number))){
						for(int i=number; i>number-size; i--){
							PBOARD[i][getlett()]="O";
						}
					}
					else{
						cout<<"Neperzenkite ribu!!!"<<endl;
						ships(size);
					}
				}
				for(int i=1; i<=10; i++){
					for(int j=1; j<=10; j++){
						if(PBOARD[i][j]!="O"){
							PBOARD[i][j]="+";
						}
					}
				}
				show(PBOARD);
			}
			else{
				cout<<"Blogai ivestos koordinates, iveskite is naujo."<<endl;
				ships(size);
			}
		}
		void randomshooting(){
			randoms();
			if(PBOARD[let][numb]=="O"){
				PBOARD[let][numb]="X";
				//smartshooting();
			}
			else if(PBOARD[let][numb]=="X"){
				PBOARD[let][numb]="X";
			}
			else{
				PBOARD[let][numb]="-";
			}
			show(PBOARD);
		}
		void smartshooting(){
			if(count==1){
				if(PBOARD[numb][let+1]=="-"){
					
				}
				if(PBOARD[numb-1][let+1]=="O"){
					PBOARD[numb-1][let+1]="X";
					for(int i=let+2; i<let+4; i++){
						PBOARD[numb-1][i]="O";
						if(PBOARD[numb-1][i]!="O"){
							break;
							count=0;
							randomshooting();
						}
						else{
							if(PBOARD[numb-1][let+1]!="O"){
								PBOARD[numb-1][let+1]="-";
								randomshooting();
							}
							count=2;
							//atiduodam ejima
						}
						}
				}
			}
			else if(count==2){
				if(PBOARD[numb-1][let-1]=="O"){
					PBOARD[numb-1][let-1]="X";
					for(int i=let-2; i>let-4; i--){
					PBOARD[numb-1][i]="O";
						if(PBOARD[numb-1][i]!="O"){
							break;
							count=0;
							randomshooting();
						}
						else{
							if(PBOARD[numb-1][let-1]!="O"){
								PBOARD[numb-1][let-1]="-";
								randomshooting();
							}
							count=3;
							//atiduodam ejima
						}
					}
				}
			}
			else if(count==3){
				if(PBOARD[numb-1][let+1]=="O"){
					PBOARD[numb-1][let+1]="X";
					for(int i=numb+2; i<numb+4; i++){
					PBOARD[i-1][let]="O";
						if(PBOARD[i-1][let]!="O"){
							break;
							count=0;
							randomshooting();
						}
						else{
							if(PBOARD[numb-1][let+1]!="O"){
								PBOARD[numb-1][let+1]="-";
								randomshooting();
							}
							count=4;
							//atiduodam ejima
						}
					}
				}
			}	
			else if(count==4){
				if(PBOARD[numb-1][let+1]=="O"){
					PBOARD[numb-1][let+1]="X";
					for(int i=numb-2; i>numb-4; i--){
					PBOARD[i-1][let]="O";
						if(PBOARD[i-1][let]!="O"){
							break;
							count=0;
							randomshooting();
						}
						else{
							if(PBOARD[numb-1][let+1]!="O"){
								PBOARD[numb-1][let+1]="-";
								randomshooting();
							}
							count=4;
							//atiduodam ejima
						}
					}
				}
			}
		}
	~computer(){
			for(int i=0; i<Cmax; i++){
				delete PBOARD[i];
			}
			delete [] PBOARD;
		}
};
/***************************************************************************************************************************************************************************/
int main(){
	srand (time(NULL));
	string CBOARD[12][12], PBOARD[12][12];
	player A;
	computer B;
	////////////////////////////////////////
	//cout<<"Zaidejo zemelapis"<<endl;	////
	//A.boardprinting(PBOARD);			////
	//cout<<endl;							////
	//cout<<"----------------------";		////		Zemelapiu isspausdinimas i ekrana
	//cout<<endl;;						////
	//cout<<"Kompiuterio zemelapis"<<endl;////
	//B.boardprinting(CBOARD);			////
	////////////////////////////////////////
	//cout<<endl;
	A.randomships(4);
	A.randomships(3);
	A.randomships(2);
	A.randomships(1);
	/*for(int i=0; i<10; i++){
		A.shooting();
	}*/
	
	//cout<<endl;
//	for(int i=1; i<100; i++){
	//	B.ships(i);	
	//}
	//B.shooting();
	//cout<<endl;
	/*for(int i=0; i<100; i++){
		cout<<endl;
		B.randomshooting();
	}*/
	return 0;
}
